import { Callout } from 'nextra-theme-docs'
import { Tab, Tabs } from 'nextra-theme-docs';
import Image from 'next/image';

# How to integrate ROQ without authentication

Welcome to the "Getting Started" page of our technical documentation! Here, you will find all the necessary information
to help you get up and running ROQ‚Äôs features **without using ROQ's authentication**. This page provides you with
step-by-step instructions for installing and configuring ROQ.

<Callout type="info" emoji="‚ÑπÔ∏è">
You can find a working and fully integrated example application based on Next.js and Prisma ORM on Github:
https://github.com/roqtech/roq-nextjs-prisma-quickstart
</Callout>

<Callout emoji="üí°">
In case you are stuck, we are just one message away. Just join the
[Community Slack](https://join.slack.com/t/roq-community/shared_invite/zt-1ly20yqpg-K03kNGxN1C7G1C0rr3TlSQ) and get
instant responses from our engineers.
</Callout>

## (1) Client side installation

Install ROQ‚Äôs UI components by running this NPM command.

<Tabs items={['React']}><Tab>

```shell
npm i --save @roq/ui-react
```

</Tab></Tabs>

At the moment, ROQ is available for React only.
However, if you need support for other libraries like Vue.js or
Angular, don't hesitate to contact us
on [Slack](https://join.slack.com/t/roq-community/shared_invite/zt-1ly20yqpg-K03kNGxN1C7G1C0rr3TlSQ).

## (2) Server side installation

On the server side of your application, you need to install [ROQ's SDK](/api-doc/sdk-api):

<Tabs items={['Node.js']}><Tab>

```shell
npm i --save @roq/nodejs
```

</Tab></Tabs>

Please create a free account in the [**console**](https://console.roq.tech) and get your environment credentials.
To install ROQ you need the `apiKey`, `environmentId` and the `host`. To learn more about the SDK, please
read
the [Using SDK](/api-doc/sdk-api) documentation.

Now you can initialize the services using the credentials on the backend-side of your application.

<Callout type="warning" emoji="‚ö†Ô∏è">
The credentials must not be shared with anyone. It's highly recommended to provide the credentials as environment
variables and don't commit them into your repository.
</Callout>

```typescript
import {Platform} from '@roq/nodejs';

const client = new Platform({
    environmentId: 'abc',
    apiKey: 'abc',
    host: 'abc',
});
```

üëÄ You can find an example usage
here: [roq-nextjs-prisma-quickstart/src/server/roq/roq.client.ts](https://github.com/roqtech/roq-nextjs-prisma-quickstart/blob/main/src/server/roq/roq.client.ts)

## (3) Synchronize user data

Before using ROQ‚Äôs feature, you need to synchronize some of your user data. This is needed for two reasons:

1. The user data needs to be present on ROQ Platform side so that user-specific JWT tokens can be created. These
   tokens are used for secure interaction between your application and ROQ.
2. The user data is also used to send emails and notifications. For instance, you may want to address your users by
   their first name in a notification template: Hi `{{recipient.firstName}}`

It‚Äôs your decision which information you wish to synchronize to ROQ. It‚Äôs recommended to send the data to ROQ after you
store it in your database using the [**`createUser()`**](/api-doc/users-api#createuser) API:

<Tabs items={['GraphQL', 'Node.js SDK']}><Tab>

```graphql
mutation {
  createUser(
    user: {
      reference: "abc123"
      email: "xyz789"
      phone: "xyz789"
      firstName: "xyz789"
      lastName: "abc123"
      locale: "en-US"
      isOptedIn: false
      active: false
    }
  ) {
    id
  }
}
```

</Tab><Tab>

```typescript
const roqUser = await client.asSuperAdmin().createUser({
    user: {
        reference: 'abc123',
        email: 'xyz789',
        firstName: 'xyz789',
        lastName: 'xyz789',
        isOptedIn: true,
        active: true,
        locale: "en-US",
    },
});
```

</Tab></Tabs>

üëÄ You can find an example usage
here: [roq-nextjs-prisma-quickstart/src/pages/api/auth/register.ts](https://github.com/roqtech/roq-nextjs-prisma-quickstart/blob/main/src/pages/api/auth/register.ts#L35)

‚ÑπÔ∏è It's important to save the returned ID on your side, so that you can use it for other features. To lean more about
the parameters, please refer to the [**`createUser()`**](/api-doc/users-api#createuser) API documentation.

## (4) Pass token from server to client-side

The AuthorisationClientService is used to fetch user tokens from ROQ Platform. You can create a token of a user with the
`createUserToken` method and the ID which you received from the `createUser` method previously:

{/* TODO replace code with SDK, see https://roqtechnology.slack.com/archives/C02C4761R9N/p1672854774743939 */}

```tsx
const roqAccessToken = await client.authorization.createUserToken(
    user.roqUserId
);
```

üëÄ You can find an example usage
here: [roq-nextjs-prisma-quickstart/src/pages/api/auth/...nextauth.ts](https://github.com/roqtech/roq-nextjs-prisma-quickstart/blob/main/src/pages/api/auth/%5B...nextauth%5D.ts#L41)

The token needs to be passed over to your client-side. The specific implementation depends on your framework. Feel
free to look into the code of the [example app](https://github.com/roqtech/roq-nextjs-prisma-quickstart) to see how it
needs to be wired-up.

## (5) Install `<RoqProvider/>` on client-side

To use ROQ's UI components, you need to wrap your application into the `<RoqProvider/>` which provides all the
required configuration. The minimum working setup requires three props: `host` (~ URL of ROQ Platform) and `getToken`.

Read the documentation about [`<RoqProvider/>`](/ui-components/roq-provider) for more details.

```tsx
import {RoqProvider} from '@roq/ui-react';
import '@roq/ui-react/dist/index.css';

function App() {
    const token = getUserToken();
    return (
        <RoqProvider
            config={{
                host: "https://...",
                token,
                socket: true,
            }}
        >
            ...
        </RoqProvider>
    );
}
```

üëÄ You can find an example usage
here: [roq-nextjs-prisma-quickstart/src/pages/_app.tsx](https://github.com/roqtech/roq-nextjs-prisma-quickstart/blob/main/src/pages/_app.tsx#L24)

## What's next

üéâüéâüéâüéâüéâ That‚Äôs it! Now you are ready to select one of the UI components and to implement and business logic based on
ROQ! You may want to start with the [chat system](/feature-guides/chat), [notifications](/feature-guides/notifications)
or [file uploads](/feature-guides/files).

If you have any questions, ideas or need support then join
our [Community Slack](https://join.slack.com/t/roq-community/shared_invite/zt-1ly20yqpg-K03kNGxN1C7G1C0rr3TlSQ) and talk
to us directly.
